!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3"),require("@ngx-chart/common"),require("@angular/core")):"function"==typeof define&&define.amd?define("@ngx-chart/doughnut",["exports","d3","@ngx-chart/common","@angular/core"],e):e((t["ngx-chart"]=t["ngx-chart"]||{},t["ngx-chart"].doughnut={}),t.d3,t.common,t.ng.core)}(this,function(t,c,e,r){"use strict";var a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function n(t,e){function r(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function i(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var a,n,i=r.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(a=i.next()).done;)s.push(a.value)}catch(o){n={error:o}}finally{try{a&&!a.done&&(r=i["return"])&&r.call(i)}finally{if(n)throw n.error}}return s}var s=(o.prototype.drawCircle=function(t,e){t=this.defaultValues(t);var r=c.arc().innerRadius(3*t.radius/5).outerRadius(t.radius).startAngle(this.circularMeasures.toRadians(t.startAngle)).endAngle(this.circularMeasures.toRadians(t.endAngle)).padAngle(function(){return t.padding?.03:0});return e.svgContainer.append("g").attr("transform","translate("+e.width/2+", "+e.height/2+")").attr("id",t.id).append("path").attr("fill",t.color).style("opacity",t.opacity).attr("d",r),r},o.prototype.defaultValues=function(t){return t.opacity=t.opacity?t.opacity:1,t},o);function o(){this.circularMeasures=new e.CircularMeasures}var l,u=(n(h,l=s),h.prototype.scaleData=function(t){var e=t.reduce(function(t,e){return t+e}),r=c.scaleLinear().domain([0,e]).range([0,100]);return t.map(function(t){return r(t)})},h.prototype.checkGraphDataColors=function(){var t=new e.Colors;return this.graphData.colors?this.graphData.colors.length===this.graphData.values.length?this.graphData.colors:function r(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t}(this.graphData.colors,t.generateRandomPallete(this.graphData.values.length-this.graphData.colors.length||0)):t.generateRandomPallete(this.graphData.values.length)},h.prototype.drawSegment=function(t,e,r){var a={id:this.graphElement.uid+"__"+r,radius:this.minSize/2,startAngle:t,endAngle:e,color:this.graphData.colors[r],padding:this.graphData.padding},n=this.drawCircle(a,this.graphElement);this.graphData.labels&&"internal"===this.graphData.labels.position&&this.appendIntLabels(this.graphElement.uid+"__"+r,n.centroid(),r),this.graphData.labels&&"external"===this.graphData.labels.position&&this.appendExtLabels(a,this.graphElement.uid+"__"+r,n.centroid(),r)},h.prototype.appendIntLabels=function(t,e,r){this.graphElement.svgContainer.select("#"+t).append("text").attr("x",e[0]).attr("y",e[1]).attr("dy","0.33em").attr("dx","-0.33em").style("fill","white").text(this.graphData.labels.titles[r])},h.prototype.appendExtLabels=function(t,e,r,a){var n=function l(t){return c.arc().innerRadius(t.radius).outerRadius(t.radius).startAngle(this.circularMeasures.toRadians(t.startAngle)).endAngle(this.circularMeasures.toRadians(t.endAngle)).centroid()}.call(this,t),i=function u(t){return c.arc().innerRadius(t.radius).outerRadius(t.radius+20).startAngle(this.circularMeasures.toRadians(t.startAngle)).endAngle(this.circularMeasures.toRadians(t.endAngle)).centroid()}.call(this,t),s=0<=i[0]?i[0]+4:i[0]-4,o=i[1]+4;this.graphElement.svgContainer.select("#"+e).append("line").style("stroke","black").style("opacity",.7).attr("x1",n[0]).attr("y1",n[1]).attr("x2",i[0]).attr("y2",i[1]),this.graphElement.svgContainer.select("#"+e).append("text").attr("text-anchor",function(){return 0<i[0]?"start":"end"}).attr("transform","translate("+s+", "+o+")").text(this.graphData.labels.titles[a])},h.propDecorators={graphData:[{type:r.Input}]},h);function h(){return l.call(this)||this}var p,g=(n(d,p=u),d.prototype.ngOnChanges=function(t){var n=this;t.graphData.previousValue&&c.select("#svg-"+this.currentElementId).remove(),this.graphElement=new e.WrapperComponentD3(this.elementRef),this.currentElementId=this.graphElement.uid,this.minSize=this.circularMeasures.calcRadius(this.graphElement.width,this.graphElement.height),this.minSize=this.graphData.labels&&"external"===this.graphData.labels.position?this.minSize-25:this.minSize,this.segmentsDegree=this.scaleData(this.graphData.values).map(function(t){return n.circularMeasures.arcValue(t)}),this.graphData.colors=this.checkGraphDataColors(),this.segmentsDegree.map(function(t,e){var r=0===e?0:n.segmentsDegree.slice(0,e).reduce(function(t,e){return t+e}),a=e===n.segmentsDegree.length?360:n.segmentsDegree.slice(0,e+1).reduce(function(t,e){return t+e});n.drawSegment(r,a,e)})},d.decorators=[{type:r.Component,args:[{selector:"ngl-doughnut",template:"",providers:[e.CircularMeasures]}]}],d.ctorParameters=function(){return[{type:r.ElementRef},{type:e.CircularMeasures}]},d);function d(t,e){var r=p.call(this)||this;return r.elementRef=t,r.circularMeasures=e,r}var f=(m.decorators=[{type:r.NgModule,args:[{declarations:[g],imports:[],exports:[g]}]}],m);function m(){}t.DoughnutGraphComponent=g,t.DoughnutGraphModule=f,t.ɵb=s,t.ɵa=u,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-chart-doughnut.umd.min.js.map